{% load static %}
{% load shuffle %}
<link rel="stylesheet" type="text/css" href="{% static 'language_evaluator/style.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'language_evaluator/rectangle.css' %}">

{% if question.image_file %}<img src="{{ question.image_file.url }}">{% endif %}
<h2>{{ question.question_text }}</h2>
{% if question.audio_file %}<audio controls><source src="{{ question.audio_file.url }}"> Your browser does not support the audio tag.</audio>{% endif %}
<form action="{% url 'test' test.id %}" method="post">
    {% csrf_token %}
    <table>
        {% if question.answer_type == 2 %}
            <input type="hidden" name="tf" id="tf" value="true">
            <tr>
                <th>Question</th>
                <th>True</th>
                <th>False</th>
            </tr>
        {% elif question.answer_type == 3 %}
            <input type="text" name="w" id="writing">
        {% elif question.answer_type == 4 %}
            <div id='result'>
                Your text will appear here.
            </div><br>
            <input type="hidden" id="speechText" name="w">
            <div id='record'>
                <!--TODO: SPEECH-TO-TEXT-->
            </div>
        {% endif %}

        {% for a in question.answer_set.all|shuffle %}
            {% if question.answer_type == 0 %}
                <tr>
                    <th><input type="radio" name="a" id="a{{ forloop.counter }}" value="{{ a.id }}"></th>
                    <th><label for="a{{ forloop.counter }}">{{ a.answer_text }}</label></th>
                </tr>
            {% elif question.answer_type == 1 %}
                 <tr>
                    <th><input type="checkbox" name="m" id="m{{ forloop.counter }}" value="{{ a.id }}"></th>
                    <th><label for="m{{ forloop.counter }}">{{ a.answer_text }}</label></th>
                </tr>
            {% elif question.answer_type == 2 %}
                <tr>
                    <th><label for="a{{ forloop.counter }}">{{ a.answer_text }}</label></th>
                    <th><input type="radio" name="tf{{ a.id }}" id="t{{ forloop.counter }}" value="T" checked></th>
                    <th><input type="radio" name="tf{{ a.id }}" id="f{{ forloop.counter }}" value="F"></th>
                </tr>
            {% endif %}
        {% endfor %}
    </table>
    <input type="submit" value="Answer">
</form>
<form action="{% url 'test' test.id %}" method="post">
    {% csrf_token %}
    {% for state in test.questions_state_list %}
        {% if state|slice:"-1:" == 'T' or state|slice:"-1:" == 'F' %}
            {% if forloop.counter0 == test.current_question %}
                <input type="submit" class="rectangle green no-text pointer chosen" name="q_picked" value="{{ forloop.counter0 }}" >
            {% else %}
                <input type="submit" class="rectangle green no-text pointer" name="q_picked" value="{{ forloop.counter0 }}" >
            {% endif %}
        {% else %}
            {% if forloop.counter0 == test.current_question %}
                <input type="submit" class="rectangle grey no-text pointer chosen" name="q_picked" value="{{ forloop.counter0 }}" >
            {% else %}
                <input type="submit" class="rectangle grey no-text pointer" name="q_picked" value="{{ forloop.counter0 }}" >
            {% endif %}
        {% endif %}
    {% endfor %}
</form>
<br>
<h5>Time left: {{ test.time_left_readable }}</h5>
<a href="{% url 'index' %}">Go to homepage</a>
<form action="{% url 'finish' test.id %}" method="post">
    {% csrf_token %}
    <button>Finish</button>
</form>